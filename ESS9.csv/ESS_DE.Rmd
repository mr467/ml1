---
title: "European Survey - What is the political sentiment in German speaking Countries Before Covid?"
author: "Milica Pajkic and Marco Rieder"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```

# Getting the Data and installing libraries

```{r, include=FALSE}
if (!require("naniar")) install.packages("naniar", dependencies=TRUE)
library(lubridate)
library(multcomp)
library(dplyr)
library(readr)
library(data.table)
library(tidyverse)
library(naniar)
```

```{r}

ess9 <- read_csv("ESS9.csv")

unique(ess9$name)
unique(ess9$gndr)
unique(ess9$cntry)
```

```{r making subsets of the whole dataset to only german speaking countries}
ess9_de <- subset(ess9, cntry == "DE", select =dweight:domain)
ess9_ch <- subset(ess9, cntry == "CH", select =dweight:domain)
ess9_at <- subset(ess9, cntry == "AT", select =dweight:domain)
```

# 1. Introduction

# 2. Descriptive Statistics

```{r }
summary(ess9_de$nwspol)
sum(is.na(ess9_de$nwspol))
```

```{r echo=FALSE}
summary(ess9_de$gndr)
sum(is.na(ess9_de$gndr))
typeof(ess9_de$nwspol)
```

```{r}
ggplot(ess9_de, aes(nwspol, 1)) +
  geom_bar(stat = "identity") + 
  xlim(c(0, 200))
```

```{r}
boxplot(ess9_de$nwspol, outline=FALSE)
```

### **Was muss man alles fÃ¼r eine deskriptive Analyse machen?**

```{r lineare Regression}
typeof(ess9_de$eduade3)
summary(ess9_de$eduade3)
sum(is.na(ess9_de$eduade3))
```

```{r recode Variable resp. clean}
#NEWS Politics time recoded
ess9_de$nwspol_na <- ess9_de$nwspol
ess9_de["nwspol_na"][ess9_de["nwspol_na"] >= 7777] <- NA
#Educationlevel  recoding
ess9_de$eduade3.na <- ess9_de$eduade3
ess9_de["eduade3.na"][ess9_de["eduade3.na"] >= 5555] <- NA
#Added "Other" also under NA bc we cannot explain what other is

#recode the age variable
ess9_de$agea.na <- ess9_de$agea
ess9_de["agea.na"][ess9_de["agea.na"] >= 140] <- NA
```

```{r checking}
summary(ess9_de$nwspol)
summary(ess9_de$nwspol_na)
sum(is.na(ess9_de$nwspol_na))
summary(ess9_de$eduade3)
summary(ess9_de$eduade3.na)

summary(ess9_de$agea)
summary(ess9_de$agea.na)
```

# 3. Models

## 3.1 Linear Model

How much politics are you watching = DV\
education level by years = IV\
happy with government = IV\
Gender = IV\
Age = IV

```{r linear Regression}
lm_news.1 <- lm(nwspol_na ~ eduade3.na, data = ess9_de)
summary(lm_news.1)
```

```{r}
lm_news.2 <- lm(nwspol_na ~ eduade3.na + agea.na, data = ess9_de)
summary(lm_news.2)
```

## 3.2 GLM Poisson

```{r}
glmP_news <- glm(nwspol ~ edu,
family = "poisson", ## we specify the distribution!
data = ess9_ch)
```

## 3.3 GLM Binominal

```{r}
glmP_news <- glm(nwspol ~ edu,
family = "poisson", ## we specify the distribution!
data = ess9_ch)
```

# 3.3 GLM Binominal

```{r}

```

## 3.3 GLM Binominal

## 3.4 GAM

## 3.5 Neural Network

## 3.6 Support Vector Machine
